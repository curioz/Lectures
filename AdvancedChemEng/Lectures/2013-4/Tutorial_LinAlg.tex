
%\documentclass[11pts,a4paper,amsmath,amssymb,floatfix]{article}%{report}%{book}
\documentclass[12pts,a4paper,amsmath,amssymb,floatfix]{article}%{report}%{book}
\usepackage{graphicx,wrapfig}% Include figure files
%\usepackage{dcolumn,enumerate}% Align table columns on decimal point
\usepackage{bm,dpfloat}% bold math
\usepackage[pdftex,bookmarks,colorlinks=true,urlcolor=rltblue,citecolor=blue]{hyperref}
\usepackage{amsfonts,amsmath,amssymb,stmaryrd,indentfirst}
\usepackage{times,psfrag}
\usepackage{natbib}
\usepackage{color}
\usepackage{units}
\usepackage{rotating}
\usepackage{multirow}
 
\usepackage{enumerate}%,enumitem}% Align table columns on decimal point

%\usepackage{pifont}
%\usepackage{subfigure}
%\usepackage{subeqnarray}
%\usepackage{ifthen}
 
\usepackage{supertabular}
\usepackage{moreverb}
\usepackage{listings}
\usepackage{palatino}
%\usepackage{doi}
\usepackage{longtable}
\usepackage{float}
\usepackage{perpage}
\MakeSorted{figure}
%\usepackage{pdflscape}


\definecolor{rltblue}{rgb}{0,0,0.75}


%\usepackage{natbib}
\usepackage{fancyhdr} %%%%
\pagestyle{fancy}%%%%
% with this we ensure that the chapter and section
% headings are in lowercase
%%%%\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}}
\fancyhf{} %delete the current section for header and footer
\fancyhead[LE,RO]{\bfseries\thepage}
\fancyhead[LO]{\bfseries\rightmark}
\fancyhead[RE]{\bfseries\leftmark}
\renewcommand{\headrulewidth}{0.5pt}
% make space for the rule
\fancypagestyle{plain}{%
\fancyhead{} %get rid of the headers on plain pages
\renewcommand{\headrulewidth}{0pt} % and the line
}

\def\newblock{\hskip .11em plus .33em minus .07em}
\usepackage{color}

%\usepackage{makeidx}
%\makeindex

\setlength\textwidth      {16.cm}
\setlength\textheight     {21.6cm}
\setlength\oddsidemargin  {-0.3cm}
\setlength\evensidemargin {0.3cm}

\setlength\headheight{14.49998pt} 
\setlength\topmargin{0.0cm}
\setlength\headsep{1.cm}
\setlength\footskip{1.cm}
\setlength\parskip{0pt}
\setlength\parindent{0pt}


%%%
%%% Headers and Footers
\lhead[] {\text{\small{EG5597 -- Advanced Chemical Engineering}}} 
\rhead[] {{\text{\small{Tutorial}}}}
%\chead[] {\text{\small{Session 2012/13}}} 
\lfoot[]{{\it Computational Methods for Fluid Dynamics}}
%\cfoot[\thepage]{\thepage}
\rfoot[\text{\small{\thepage}}]{\thepage}
\renewcommand{\headrulewidth}{0.8pt}


%%%
%%% space between lines
%%%
\renewcommand{\baselinestretch}{1.5}

\newenvironment{VarDescription}[1]%
  {\begin{list}{}{\renewcommand{\makelabel}[1]{\textbf{##1:}\hfil}%
    \settowidth{\labelwidth}{\textbf{#1:}}%
    \setlength{\leftmargin}{\labelwidth}\addtolength{\leftmargin}{\labelsep}}}%
  {\end{list}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%                              %%%%%%%
%%%%%%      NOTATION SECTION        %%%%%%%
%%%%%%                              %%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Text abbreviations.
\newcommand{\ie}{{\em{i.e., }}}
\newcommand{\eg}{{\em{e.g., }}}
\newcommand{\cf}{{\em{cf., }}}
\newcommand{\wrt}{with respect to}
\newcommand{\lhs}{left hand side}
\newcommand{\rhs}{right hand side}
% Commands definining mathematical notation.

% This is for quantities which are physically vectors.
\renewcommand{\vec}[1]{{\mbox{\boldmath$#1$}}}
% Physical rank 2 tensors
\newcommand{\tensor}[1]{\overline{\overline{#1}}}
% This is for vectors formed of the value of a quantity at each node.
\newcommand{\dvec}[1]{\underline{#1}}
% This is for matrices in the discrete system.
\newcommand{\mat}[1]{\mathrm{#1}}


\DeclareMathOperator{\sgn}{sgn}
\newtheorem{thm}{Theorem}[section]
\newtheorem{lemma}[thm]{Lemma}

%\newcommand\qed{\hfill\mbox{$\Box$}}
\newcommand{\re}{{\mathrm{I}\hspace{-0.2em}\mathrm{R}}}
\newcommand{\inner}[2]{\langle#1,#2\rangle}
\renewcommand\leq{\leqslant}
\renewcommand\geq{\geqslant}
\renewcommand\le{\leqslant}
\renewcommand\ge{\geqslant}
\renewcommand\epsilon{\varepsilon}
\newcommand\eps{\varepsilon}
\renewcommand\phi{\varphi}
\newcommand{\bmF}{\vec{F}}
\newcommand{\bmphi}{\vec{\phi}}
\newcommand{\bmn}{\vec{n}}
\newcommand{\bmns}{{\textrm{\scriptsize{\boldmath $n$}}}}
\newcommand{\bmi}{\vec{i}}
\newcommand{\bmj}{\vec{j}}
\newcommand{\bmk}{\vec{k}}
\newcommand{\bmx}{\vec{x}}
\newcommand{\bmu}{\vec{u}}
\newcommand{\bmv}{\vec{v}}
\newcommand{\bmr}{\vec{r}}
\newcommand{\bma}{\vec{a}}
\newcommand{\bmg}{\vec{g}}
\newcommand{\bmU}{\vec{U}}
\newcommand{\bmI}{\vec{I}}
\newcommand{\bmq}{\vec{q}}
\newcommand{\bmT}{\vec{T}}
\newcommand{\bmM}{\vec{M}}
\newcommand{\bmtau}{\vec{\tau}}
\newcommand{\bmOmega}{\vec{\Omega}}
\newcommand{\pp}{\partial}
\newcommand{\kaptens}{\tensor{\kappa}}
\newcommand{\tautens}{\tensor{\tau}}
\newcommand{\sigtens}{\tensor{\sigma}}
\newcommand{\etens}{\tensor{\dot\epsilon}}
\newcommand{\ktens}{\tensor{k}}
\newcommand{\half}{{\textstyle \frac{1}{2}}}
\newcommand{\tote}{E}
\newcommand{\inte}{e}
\newcommand{\strt}{\dot\epsilon}
\newcommand{\modu}{|\bmu|}
% Derivatives
\renewcommand{\d}{\mathrm{d}}
\newcommand{\D}{\mathrm{D}}
\newcommand{\ddx}[2][x]{\frac{\d#2}{\d#1}}
\newcommand{\ddxx}[2][x]{\frac{\d^2#2}{\d#1^2}}
\newcommand{\ddt}[2][t]{\frac{\d#2}{\d#1}}
\newcommand{\ddtt}[2][t]{\frac{\d^2#2}{\d#1^2}}
\newcommand{\ppx}[2][x]{\frac{\partial#2}{\partial#1}}
\newcommand{\ppxx}[2][x]{\frac{\partial^2#2}{\partial#1^2}}
\newcommand{\ppt}[2][t]{\frac{\partial#2}{\partial#1}}
\newcommand{\pptt}[2][t]{\frac{\partial^2#2}{\partial#1^2}}
\newcommand{\DDx}[2][x]{\frac{\D#2}{\D#1}}
\newcommand{\DDxx}[2][x]{\frac{\D^2#2}{\D#1^2}}
\newcommand{\DDt}[2][t]{\frac{\D#2}{\D#1}}
\newcommand{\DDtt}[2][t]{\frac{\D^2#2}{\D#1^2}}
% Norms
\newcommand{\Ltwo}{\ensuremath{L_2} }
% Basis functions
\newcommand{\Qone}{\ensuremath{Q_1} }
\newcommand{\Qtwo}{\ensuremath{Q_2} }
\newcommand{\Qthree}{\ensuremath{Q_3} }
\newcommand{\QN}{\ensuremath{Q_N} }
\newcommand{\Pzero}{\ensuremath{P_0} }
\newcommand{\Pone}{\ensuremath{P_1} }
\newcommand{\Ptwo}{\ensuremath{P_2} }
\newcommand{\Pthree}{\ensuremath{P_3} }
\newcommand{\PN}{\ensuremath{P_N} }
\newcommand{\Poo}{\ensuremath{P_1P_1} }
\newcommand{\PoDGPt}{\ensuremath{P_{-1}P_2} }

\newcommand{\metric}{\tensor{M}}
\newcommand{\configureflag}[1]{\texttt{#1}}

% Units
\newcommand{\m}[1][]{\unit[#1]{m}}
\newcommand{\km}[1][]{\unit[#1]{km}}
\newcommand{\s}[1][]{\unit[#1]{s}}
\newcommand{\invs}[1][]{\unit[#1]{s}\ensuremath{^{-1}}}
\newcommand{\ms}[1][]{\unit[#1]{m\ensuremath{\,}s\ensuremath{^{-1}}}}
\newcommand{\mss}[1][]{\unit[#1]{m\ensuremath{\,}s\ensuremath{^{-2}}}}
\newcommand{\K}[1][]{\unit[#1]{K}}
\newcommand{\PSU}[1][]{\unit[#1]{PSU}}
\newcommand{\Pa}[1][]{\unit[#1]{Pa}}
\newcommand{\kg}[1][]{\unit[#1]{kg}}
\newcommand{\rads}[1][]{\unit[#1]{rad\ensuremath{\,}s\ensuremath{^{-1}}}}
\newcommand{\kgmm}[1][]{\unit[#1]{kg\ensuremath{\,}m\ensuremath{^{-2}}}}
\newcommand{\kgmmm}[1][]{\unit[#1]{kg\ensuremath{\,}m\ensuremath{^{-3}}}}
\newcommand{\Nmm}[1][]{\unit[#1]{N\ensuremath{\,}m\ensuremath{^{-2}}}}

% Dimensionless numbers
\newcommand{\dimensionless}[1]{\mathrm{#1}}
\renewcommand{\Re}{\dimensionless{Re}}
\newcommand{\Ro}{\dimensionless{Ro}}
\newcommand{\Fr}{\dimensionless{Fr}}
\newcommand{\Bu}{\dimensionless{Bu}}
\newcommand{\Ri}{\dimensionless{Ri}}
\renewcommand{\Pr}{\dimensionless{Pr}}
\newcommand{\Pe}{\dimensionless{Pe}}
\newcommand{\Ek}{\dimensionless{Ek}}
\newcommand{\Gr}{\dimensionless{Gr}}
\newcommand{\Ra}{\dimensionless{Ra}}
\newcommand{\Sh}{\dimensionless{Sh}}
\newcommand{\Sc}{\dimensionless{Sc}}


% Journals
\newcommand{\IJHMT}{{\it International Journal of Heat and Mass Transfer}}
\newcommand{\NED}{{\it Nuclear Engineering and Design}}
\newcommand{\ICHMT}{{\it International Communications in Heat and Mass Transfer}}
\newcommand{\NET}{{\it Nuclear Engineering and Technology}}
\newcommand{\HT}{{\it Heat Transfer}}   
\newcommand{\IJHT}{{\it International Journal for Heat Transfer}}

\newcommand{\frc}{\displaystyle\frac}
\newenvironment{frcseries}{\fontfamily{frc}\selectfont}{}
\newcommand{\textfrc}[1]{{\frcseries#1}}

%\usepackage{enumitem}%
%\newlist{ExList}{enumerate}{1}
%\setlist[ExList,1]{label={\bf Example 1.} {\bf \arabic*}}

%\newlist{ProbList}{enumerate}{1}
%\setlist[ProbList,1]{label={\bf Problem 1.} {\bf \arabic*}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%                              %%%%%%%
%%%%%% END OF THE NOTATION SECTION  %%%%%%%
%%%%%%                              %%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Cause numbering of subsubsections. 
%\setcounter{secnumdepth}{8}
%\setcounter{tocdepth}{8}

\setcounter{secnumdepth}{4}%
\setcounter{tocdepth}{4}%


\begin{document}

\begin{flushright}
{\bf \today}
\end{flushright}

\begin{enumerate}[{\bf Problem 1:}]
%
%%%
\item Three continuous stirred-tank reactors operating in series are used to produce ethanol. In each reactor the concentration of {\it EtOH},  $C_{i}$ $\left(\text{with }i\in\left\{1, 2, 3\right\}\text{ and } g/cm^{3}\right)$, is determined at the inlet of each reactor and can be expressed as,
\begin{displaymath}
\begin{cases}
17C_{1} -2C_{2} - 3C_{3} = 500 \\
-5C_{1} + 21C_{2} - 2C_{3} = 200 \\
-5C_{1} - 5C_{2} + 22C_{3} = 30
\end{cases}
\end{displaymath}
\begin{enumerate}
\item Assess the convergence of the resulting linear system;
\item Calculate $C_{i}$ after 2 iterations via Gauss-Seidel and Jacobi methods using $\left(34.0\;\;19.0\;\;13.0\right)^{T}$ as initial estimation;
\item Design your own code (Matlab, Python, C, Fortran, Excel etc) to solve this linear system using Gauss-Seidel, Jacobi and SOR ($\omega=0.8$ and $\omega=1.2$) iterative methods. Use $\left(0.0\;\;1.0\;\;1.0\right)^{T}$ as initial guess and
\begin{displaymath}
\frc{\left|\left|\bm{x}^{(k+1)}-\bm{x}^{(k)}\right|\right|}{\left|\left|\bm{x}^{(k)}\right|\right|} \le 10^{-4}
\end{displaymath}
as stoppage criteria. How many iterations will each method use to converge to the solution? 
\end{enumerate} 

%%%
\item Solve the following system of equations via Gaussian elimination:
\begin{displaymath}
             \begin{pmatrix}
                7 & 1 & 3 & 2 \\ 3 & 12 & 1 & 5 \\ 0 & 0 & 8 & 1 \\ 1 & 3 & 2 & 9
             \end{pmatrix}
             \begin{pmatrix}
                x_{1} \\ x_{2} \\ x_{3} \\ x_{4}
             \end{pmatrix}=
             \begin{pmatrix}
                2 \\ 4 \\  1 \\ 15
             \end{pmatrix}
\end{displaymath}
%

%%%
\item An engineer consultant is hired to help in the design of a new F1-car front-wing air-foil. The back part of the air-foil is in contact with the car nose (chassis) and the outer part is in contact with flowing air. At first, the engineer needs to know the temperature profile across the wing as the temperature of chassis is at 200$^{o}$C and the ambient air temperature is at 20$^{o}$C. Heat loss in the tip of the air-foil is assumed negligible. The engineer also assumed that air is incompressible and that the nose and air temperatures are constant. The temperature across the air-foil can be expressed as an 1-D elliptic partial differential equation,
\begin{displaymath}
\frc{\partial^{2} T}{\partial x^{2}} -\alpha T = -\alpha T_{\text{amb}}
\end{displaymath} 
where $\alpha=20\;^{\text{o}}$C.m$^{-2}$ and $T_{\text{amb}}$ is the temperature of the flowing air. Estimate the temperature profile at 3 nodes equally spaced in the air-foil of length $L=0.30$m.


%%%
\item Calculate using Gauss-Jordan method:
\begin{enumerate}
\item $\bm{A}^{-1}$ where $\bm{A} = \begin{pmatrix}
1 & 0 & 0 & 0 \\ 1 & 1 & 0 & 0 \\ 1 & 2 & 1 & 0 \\ 1 & 3 & 3 & 1
\end{pmatrix}$

\item Solve $\bm{A}x=b$ using the inverse of $\bm{A}$ where $\bm{A}=\begin{pmatrix}0 & 0 & 0 & 2 \\ 0 & 0 & 3 & 0 \\ 0 & 4 & 0 & 0 \\ 5 & 0 & 0  & 0 \end{pmatrix}$ and $b=\left(12\;\; 15\;\;  8\;\; 5\right)^{T}$. 
\end{enumerate}

\end{enumerate}

\clearpage

\begin{center}
{\bf {\Large Summary of FD approximations for PDEs}}
\end{center}

\begin{center}
\begin{longtable}{|| c | c | c | c ||} 
%\begin{tabular}{|| c | c | c | c ||}
\hline\hline
            & {\bf FD approximation}  & {\bf Type}  & {\bf Order} \\
\hline\hline
& & & \\
$\frc{\partial\phi}{\partial x}$ & $\frc{\phi_{i+1}^{n}-\phi_{i}^{n}}{\Delta x}$ & Forward & $\mathcal{O}\left(\Delta x\right)$  \\ 
& & & \\
\hline
& & & \\
$\frc{\partial\phi}{\partial x}$ & $\frc{-\phi_{i+2}^{n}+6\phi_{i+1}^{n}-3\phi_{i}^{n}-2\phi_{i-1}^{n}}{6\Delta x}$ & Forward & $\mathcal{O}\left(\Delta x\right)^{3}$   \\   
& & & \\
\hline

& & & \\
$\frc{\partial\phi}{\partial x}$ & $\frc{\phi_{i}^{n}-\phi_{i-1}^{n}}{\Delta x}$ & Backward & $\mathcal{O}\left(\Delta x\right)$  \\ 
& & & \\
\hline
& & & \\
$\frc{\partial\phi}{\partial x}$ & $\frc{2\phi_{i+1}^{n}+3\phi_{i}^{n}-6\phi_{i-1}^{n}+\phi_{i-1}^{n}}{6\Delta x}$ & Backward & $\mathcal{O}\left(\Delta x\right)^3$  \\ 
& & & \\
\hline


& & & \\
$\frc{\partial\phi}{\partial x}$ & $\frc{\phi_{i+1}^{n}-\phi_{i-1}^{n}}{2\Delta x}$ & Central & $\mathcal{O}\left(\Delta x\right)^{2}$  \\ 
& & & \\
\hline
& & & \\
$\frc{\partial\phi}{\partial x}$ & $\frc{-\phi_{i+2}^{n}+8\phi_{i+1}^{n}-\phi_{i-1}^{n}+\phi_{i-2}^{n}}{12\Delta x}$ & Central & $\mathcal{O}\left(\Delta x\right)^{4}$  \\ 
& & & \\
\hline


& & & \\
$\frc{\partial^{2}\phi}{\partial x^{2}}$ & $\frc{\phi_{i+1}^{n}-2\phi_{i}^{n}+\phi_{i-1}^{n}}{\left(\Delta x\right)^{2}}$ & Central & $\mathcal{O}\left(\Delta x\right)^{2}$  \\ 
& & & \\
\hline
& & & \\
$\frc{\partial^{2}\phi}{\partial x^{2}}$ & $\frc{-\phi_{i+2}^{n}-16\phi_{i+1}^{n}-30\phi_{i}^{n}+16\phi_{i-1}^{n}-\phi_{i-2}^{n}}{\left(12\Delta x\right)^{2}}$ & Central & $\mathcal{O}\left(\Delta x\right)^{4}$  \\ 
& & & \\
\hline

& & & \\
$\frc{\partial\phi}{\partial t}$ & $\frc{\phi_{i}^{n+1}-\phi_{i}^{n}}{\Delta t}$ & Forward & $\mathcal{O}\left(\Delta t\right)$  \\ 
& & & \\
\hline
& & & \\
$\frc{\partial\phi}{\partial t}$ & $\frc{\phi_{i}^{n}-\phi_{i}^{n-1}}{\Delta t}$ & Backward & $\mathcal{O}\left(\Delta t\right)$  \\ 
& & & \\
\hline
& & & \\
$\frc{\partial\phi}{\partial t}$ & $\frc{\phi_{i}^{n+1}-\phi_{i}^{n-1}}{2\Delta t}$ & Central & $\mathcal{O}\left(\Delta t\right)^{2}$  \\ 
& & & \\
\hline
& & & \\
$\frc{\partial^{2}\phi}{\partial t^{2}}$ & $\frc{\phi_{i}^{n+1}-2\phi_{i}^{n}+\phi_{i}^{n-1}}{\left(\Delta t\right)^{2}}$ & Symmetric & $\mathcal{O}\left(\Delta t\right)^{2}$  \\ 
& & & \\
\hline


\hline\hline
%\end{tabular}

\end{longtable}
\end{center}

\end{document}
